<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper	namespace="com.court.supporter.announce.service.AnnounceMapper">

	<insert id="announceRegist" parameterType="TB_002VO"> <!-- 공고 등록 -->
		insert into TB_002(announce_title,
							announce_content,
							announce_start_date,
							announce_end_date,
							admin_proper_num,
							trial_fcltt_proper_num
							)
		values(#{announce_title},
		#{announce_content},
		#{announce_start_date},
		#{announce_end_date},
		#{admin_proper_num},
		#{trial_fcltt_proper_num}
		);

	</insert>

	<select id="announce_getTotal">
		select count(*) as total
		from TB_002
		where 1 = 1
		<if test="cri.announce_title != '' and cri.announce_title != null">
			and announce_title like concat('%', #{cri.announce_title}, '%')
		</if>
		<if	test="cri.announce_content != '' and cri.announce_content != null">
			and announce_content like concat('%', #{cri.announce_content}, '%' )
		</if>
		<if
			test="cri.announce_start_date != '' and cri.announce_start_date != null">
         <![CDATA[and announce_start_date >= #{cri.announce_start_date}]]>
		</if>
		<if
			test="cri.announce_end_date != '' and cri.announce_end_date != null">
         <![CDATA[and announce_end_date <= #{cri.announce_end_date}]]>
		</if>
		order by announce_proper_num desc
		
	</select>

	<select id="announce_getList">
		select TB_002.*,
		CONVERT(announce_start_date, CHAR) AS announce_start_date_as_varchar,
		CONVERT(announce_end_date, CHAR) AS announce_end_date_as_varchar
		from TB_002
		where 1 = 1
		<if test="cri.announce_title != '' and cri.announce_title != null">
			and announce_title like concat('%', #{cri.announce_title}, '%')
		</if>
		<if	test="cri.announce_content != '' and cri.announce_content != null">
			and announce_content like concat('%', #{cri.announce_content}, '%')
		</if>
		<if test="cri.announce_start_date != '' and cri.announce_start_date != null">
         <![CDATA[and announce_start_date >= #{cri.announce_start_date}]]>
		</if>
		<if test="cri.announce_end_date != '' and cri.announce_end_date != null">
         <![CDATA[and announce_end_date <= #{cri.announce_end_date}]]>
		</if>
		order by announce_proper_num desc
		limit #{cri.pageStart}, #{cri.amount}
	</select>



	<select id="getDetail" resultType="TB_002VO"> <!-- 공고 게시글 상세화면 -->
		select * from TB_002 where announce_proper_num = #{announce_proper_num}
	</select>



</mapper>